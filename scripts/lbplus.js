function onYouTubeIframeAPIReady(){video.player=new YT.Player(video.selector,{width:"649",height:"360",videoId:video.vId,playerVars:{autoplay:0,controls:0,disablekb:1,enablejsapi:1,iv_load_policy:3,loop:0,modestbranding:1,rel:0,showinfo:0},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}})}function onPlayerReady(){var e=video.player.getDuration();e=1e3*e,e=moment(e).format("mm:ss"),$(".progress_bar .time .duration").html(e),loadStartBtnEvent(),setInterval(updateProgress,100),$(".dev-log").append("YouTube player ready.<br />")}function onPlayerStateChange(e){var t=e.target.getPlayerState(),a=["ended","playing","paused","buffering",,"video cued"],o=null;switch(o=-1===t?"unstarted":a[t],$(".dev-log").append(o+"<br />"),t){case YT.PlayerState.ENDED:$(".lbplus_wrapper").showTransition("Video Ended","Calculating results. Please wait..."),$(".lbplus_media .overlay").html('<div id="videoPlayBtn">START</div>'),loadStartBtnEvent();for(var n=0;n<$(".btn[data-action]").length;n++)$(".btn[data-action]:eq("+n+")").addClass("disabled");$("#stopVideoBtn").attr("disabled",""),$(".dev-log").append("Video ended. Transition overlay should be shown. Start button should be redisplayed. Action buttons should be disabled.<br />");break;case YT.PlayerState.PLAYING:$(".dev-log").append("Video playing... allow buttons to be clickable.<br />");for(var d=0;d<$(".btn[data-action]").length;d++)$(".btn[data-action]:eq("+d+")").removeClass("disabled"),$(".btn[data-action]:eq("+d+")").clicked()}}function loadStartBtnEvent(){$("#videoPlayBtn").on("click",function(){$(this).remove(),video.player.playVideo(),$("#stopVideoBtn").removeAttr("disabled")})}function updateProgress(){var e=video.player.getCurrentTime(),t=timeToProgressBarPx(e),a=moment(1e3*e).format("mm:ss");$(".progress_bar .progressed").css("width",t+"px"),$(".progress_bar .time .elapsed").html(a)}function timeToProgressBarPx(e){var t=video.player.getDuration(),a=$(".progress_bar").width();return a*(e/t)}function addTag(e){var t=video.player.getCurrentTime(),a=$(e).data("action"),o=moment(1e3*t).format("mm:ss"),n=timeToProgressBarPx(t)+10,d=$(e).children("span.icon").html(),s='<span class="tag" data-action="'+a+'" data-time="'+o+'" style="left:'+n+'px">'+d+"</span></span>";$(".progress_bar_holder").prepend(s)}var soundEffects={click:"click",powerUp:"power_up",odd:"no_mercy"},video={player:null,selector:"ytv",vId:null};$(document).ready(function(){$.fn.loadSoundEffects(),$(".dev-log").append("Button sounds loaded.<br />"),video.vId=$("#"+video.selector).attr("data-videoId"),$.fn.loadYouTubeAPI(),$(".progress_bar").progress()}),$.fn.loadSoundEffects=function(){$.each(soundEffects,function(e,t){var a=t;soundEffects[e]=document.createElement("audio"),soundEffects[e].setAttribute("src","sounds/"+a+".mp3")})},$.fn.loadYouTubeAPI=function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.src="https://www.youtube.com/iframe_api",t.parentNode.insertBefore(e,t),$(".dev-log").append("YouTube API loaded.<br />")},$.fn.clicked=function(){$(this).on("click",function(){$(this).hasClass("disabled")||(addTag(this),$(this).hasClass("odd")?soundEffects.odd.play():soundEffects.powerUp.play(),$(".dev-log").append($(this).find(".action_name").html()+" @ "+moment(1e3*video.player.getCurrentTime()).format("mm:ss")+" <br />"),$(this).cooldown())})},$.fn.cooldown=function(){var e=$(this).index(".btn"),t=$(this),a=t.width(),o=1e3*Number(t.attr("data-cooldown")),n=t.find(".cooldown .progress"),d=$(n.selector+":eq("+e+")"),s=$(this).find(".limits"),i=Number(s.html());d.width()>=a&&(d.width(0),t.addClass("disabled")),i--,s.html(i),$(".dev-log").append("Subtracting limit by one, cooling down... "+i+" remain<br />"),0>=i?$(this).addClass("disabled"):d.animate({width:a},o,function(){t.removeClass("disabled")})},$.fn.progress=function(){{var e=$(this),t=(e.width(),e.find(".progressed"));$(t.selector)}},$.fn.showTransition=function(e,t){$(this).prepend('<div class="transition_overlay"><div class="heading">'+e+'</div><div class="subheading">'+t+'</div><div class="loading"><span class="icon-spinner spin"></span></div></div>'),$(".transition_overlay").css("display","none").fadeIn(),$(".dev-log").append("Transition overlay toggled on.<br />")},$.fn.hideTransition=function(){$(".transition_overlay").fadeOut(function(){$(this).remove()}),$(".dev-log").append("Transition overlay toggled off.<br />")};